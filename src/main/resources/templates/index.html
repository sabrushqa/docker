<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G√©n√©rateur de CV</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&family=Roboto&display=swap" rel="stylesheet">
    <link th:href="@{/css/style.css}" rel="stylesheet">
</head>
<body>
    <div class="container">
        <div class="form-section">
            <h1>Cr√©ez votre CV</h1>
            <form id="cvForm" th:action="@{/generate-cv}" th:object="${cvForm}" method="post">
                <!-- Informations personnelles -->
                <div class="form-group">
                    <h2>Informations personnelles</h2>
                    <div class="input-with-emoji">
                        <input type="text" id="fullName" th:field="*{fullName}" placeholder="Nom complet" required>
                        <button type="button" class="emoji-trigger" data-target="fullName" data-default="üë§">üë§</button>
                    </div>
                    <div class="input-with-emoji">
                        <input type="email" id="email" th:field="*{email}" placeholder="Email" required>
                        <button type="button" class="emoji-trigger" data-target="email" data-default="üìß">üìß</button>
                    </div>
                    <div class="input-with-emoji">
                        <input type="tel" id="phone" th:field="*{phone}" placeholder="T√©l√©phone">
                        <button type="button" class="emoji-trigger" data-target="phone" data-default="üìû">üìû</button>
                    </div>
                    <div class="input-with-emoji">
                        <input type="text" id="location" th:field="*{location}" placeholder="Localisation">
                        <button type="button" class="emoji-trigger" data-target="location" data-default="üìç">üìç</button>
                    </div>
                    <input type="file" id="photo" name="photo" accept="image/*">
                </div>

                <!-- R√©sum√© -->
                <div class="form-group">
                    <h2>R√©sum√© professionnel</h2>
                    <div class="input-with-emoji">
                        <textarea id="summary" th:field="*{summary}" rows="4" placeholder="Bref r√©sum√© de votre profil"></textarea>
                        <button type="button" class="emoji-trigger" data-target="summary" data-default="üìù">üìù</button>
                    </div>
                </div>

                <!-- Exp√©rience -->
                <div class="form-group" id="experienceContainer">
                    <h2>Exp√©rience professionnelle</h2>
                    <div th:each="experience, stat : *{experiences}" class="experience-entry">
                        <div class="input-with-emoji">
                            <input type="text" th:field="*{experiences[__${stat.index}__].title}" placeholder="Titre du poste">
                            <button type="button" class="emoji-trigger" data-target="experience-title" data-default="üíº">üíº</button>
                        </div>
                        <div class="input-with-emoji">
                            <input type="text" th:field="*{experiences[__${stat.index}__].company}" placeholder="Entreprise">
                            <button type="button" class="emoji-trigger" data-target="experience-company" data-default="üè¢">üè¢</button>
                        </div>
                        <input type="text" th:field="*{experiences[__${stat.index}__].location}" placeholder="Localisation">
                        <input type="date" th:field="*{experiences[__${stat.index}__].startDate}" placeholder="Date de d√©but">
                        <input type="date" th:field="*{experiences[__${stat.index}__].endDate}" placeholder="Date de fin">
                        <div class="input-with-emoji">
                            <textarea th:field="*{experiences[__${stat.index}__].description}" placeholder="Description des responsabilit√©s"></textarea>
                            <button type="button" class="emoji-trigger" data-target="experience-description" data-default="üìã">üìã</button>
                        </div>
                    </div>
                    <button type="button" class="add-btn" onclick="addExperience()">+ Ajouter une exp√©rience</button>
                </div>

                <!-- Formation -->
                <div class="form-group" id="educationContainer">
                    <h2>Formation</h2>
                    <div th:each="education, stat : *{educations}" class="education-entry">
                        <div class="input-with-emoji">
                            <input type="text" th:field="*{educations[__${stat.index}__].degree}" placeholder="Dipl√¥me">
                            <button type="button" class="emoji-trigger" data-target="education-degree" data-default="üéì">üéì</button>
                        </div>
                        <div class="input-with-emoji">
                            <input type="text" th:field="*{educations[__${stat.index}__].school}" placeholder="√âcole">
                            <button type="button" class="emoji-trigger" data-target="education-school" data-default="üè´">üè´</button>
                        </div>
                        <input type="text" th:field="*{educations[__${stat.index}__].location}" placeholder="Localisation">
                        <input type="date" th:field="*{educations[__${stat.index}__].startDate}" placeholder="Date de d√©but">
                        <input type="date" th:field="*{educations[__${stat.index}__].endDate}" placeholder="Date de fin">
                        <div class="input-with-emoji">
                            <textarea th:field="*{educations[__${stat.index}__].description}" placeholder="Description"></textarea>
                            <button type="button" class="emoji-trigger" data-target="education-description" data-default="üìö">üìö</button>
                        </div>
                    </div>
                    <button type="button" class="add-btn" onclick="addEducation()">+ Ajouter une formation</button>
                </div>

                <!-- Skills section -->
                <div class="form-group" id="skillsContainer">
                    <h2>Comp√©tences</h2>
                    <div th:each="skill, stat : *{skills}" class="skills-entry">
                        <div class="input-with-emoji">
                            <input type="text" th:field="*{skills[__${stat.index}__].name}" placeholder="Comp√©tence">
                            <button type="button" class="emoji-trigger" data-target="skill" data-default="‚≠ê">‚≠ê</button>
                        </div>
                        <select th:field="*{skills[__${stat.index}__].level}">
                            <option value="expert">Expert</option>
                            <option value="avance">Avanc√©</option>
                            <option value="intermediaire">Interm√©diaire</option>
                            <option value="debutant">D√©butant</option>
                        </select>
                    </div>
                    <button type="button" class="add-btn" onclick="addSkill()">+ Ajouter une comp√©tence</button>
                </div>

                <!-- Langues -->
                <div class="form-group" id="languagesContainer">
                    <h2>Langues</h2>
                    <div th:each="language, stat : *{languages}" class="language-entry">
                        <div class="input-with-emoji">
                            <input type="text" th:field="*{languages[__${stat.index}__].name}" placeholder="Langue">
                            <button type="button" class="emoji-trigger" data-target="language" data-default="üó£Ô∏è">üó£Ô∏è</button>
                        </div>
                        <select th:field="*{languages[__${stat.index}__].level}">
                            <option value="debutant">D√©butant</option>
                            <option value="intermediaire">Interm√©diaire</option>
                            <option value="avance">Avanc√©</option>
                            <option value="bilingue">Bilingue</option>
                        </select>
                    </div>
                    <button type="button" class="add-btn" onclick="addLanguage()">+ Ajouter une langue</button>
                </div>

                <!-- Personnalisation -->
                <div class="form-group">
                    <h2>Personnalisation</h2>
                    <div class="customization-options">
                        <div class="color-picker">
                            <input type="color" id="themeColor" th:field="*{themeColor}" value="#1e88e5">
                            <label for="themeColor">Couleur du th√®me</label>
                        </div>
                        <div class="font-picker">
                            <select id="fontFamily" th:field="*{fontFamily}" onchange="updateFont(this.value)">
                                <option value="Roboto">Roboto</option>
                                <option value="Open Sans">Open Sans</option>
                            </select>
                            <label for="fontFamily">Police d'√©criture</label>
                        </div>
                    </div>
                </div>

                <!-- Boutons d'export -->
                <div class="export-buttons">
                    <button type="submit" class="btn-primary">G√©n√©rer CV</button>
                    <button type="button" onclick="window.print()" class="btn-secondary">Imprimer</button>
                </div>
            </form>
        </div>

        <div class="preview-section">
            <div id="cvPreview" class="cv-preview" th:fragment="preview">
                <!-- Le CV sera g√©n√©r√© ici -->
                <div th:if="${cv != null}" th:replace="fragments/cv-preview :: cv(${cv})"></div>
            </div>
        </div>
    </div>

    <emoji-picker id="emojiPicker" class="light"></emoji-picker>
    <script th:src="@{/js/main.js}" type="module"></script>
</body>
</html>